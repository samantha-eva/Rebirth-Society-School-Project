{% extends 'base.html.twig' %}

{% block title %}Rebirth Society School{% endblock %}

{% block body %}
<main class="container mx-auto px-4 py-8 max-w-7xl">

  <div class="text-center mb-12">
    <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-4 tracking-tight">
      shop Vid√©o
    </h1>
    <p class="text-lg text-gray-300 leading-relaxed max-w-3xl mx-auto">
      Discover our individual lessons and exclusive packages to progress at your own pace.
    </p>
  </div>

  {# --- Filtres --- #}
  <div class="flex flex-wrap justify-center gap-4 mb-12">
    {% for cat in ['all', 'Afro', 'Hip Hop', 'Kizomba'] %}
      <a href="{{ path('app_shop', {'page': 1, 'filter': cat}) }}"
         class="px-5 py-2 rounded-full text-sm font-semibold transition 
                {% if filter == cat %}
                  bg-[var(--gold,#f9b006)] text-black hover:bg-yellow-400
                {% else %}
                  bg-black text-[var(--gold,#f9b006)] border border-[var(--gold,#f9b006)] hover:bg-[var(--gold,#f9b006)] hover:text-black
                {% endif %}">
        {{ cat == 'all' ? 'Tous' : (cat == 'Hip Hop' ? 'Hip Hop' : (cat == 'Kizomba' ? 'Kizomba' : 'Afro')) }}
      </a>
    {% endfor %}
  </div>

  {# --- Liste des √©l√©ments --- #}
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
    {% for el in elements %}
      <div class="bg-black rounded-2xl shadow-xl overflow-hidden border border-gray-800 group flex flex-col hover:shadow-2xl transition">
        <div class="relative">
          <div class="w-full bg-center bg-no-repeat aspect-[3/4] bg-cover"
               style="background-image: url('{{ asset('uploads/packs/' ~ el.image) }}');">
          </div>
          <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-70 group-hover:opacity-90 transition-all duration-300"></div>

          <div class="absolute top-4 left-4 flex items-center gap-2">
            {% if el.type == 'pack' %}
              <span class="px-3 py-1 text-xs font-semibold uppercase rounded-full bg-[var(--gold,#f9b006)] text-black shadow">üéÅ Pack</span>
            {% else %}
              <span class="px-3 py-1 text-xs font-semibold uppercase rounded-full bg-[var(--gold,#f9b006)] text-black shadow">üé• Vid√©o</span>
            {% endif %}
          </div>

          <div class="absolute top-4 right-4">
            <span class="px-3 py-1 text-sm font-bold rounded-full bg-[var(--gold,#f9b006)] text-black shadow-lg">{{ el.price }} ‚Ç¨</span>
          </div>

          <div class="absolute bottom-4 left-4 right-4 space-y-2">
            <h3 class="text-white text-xl font-bold drop-shadow">{{ el.nom }}</h3>
            {% if el.type == 'pack' %}
              <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full bg-gray-900/80 text-[var(--gold,#f9b006)] border border-[var(--gold,#f9b006)]">
                üì¶ {{ el.videos|length }} Videos included
              </span>
            {% else %}
              <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full bg-gray-900/80 text-[var(--gold,#f9b006)] border border-[var(--gold,#f9b006)]">
                üìÇ {{ el.categorie.name }}
              </span>
            {% endif %}
          </div>
        </div>
        <div class="mt-auto p-4 text-center">
          <a href="{{ el.type == 'pack' 
                    ? path('pack_detail', {'id': el.id}) 
                    : path('video_detail', {'id': el.id}) }}"
            class="bg-[var(--gold,#f9b006)] text-black px-5 py-2 rounded-full font-semibold hover:bg-yellow-400 transition inline-block">
              {{ el.type == 'pack' ? 'D√©couvrir le pack' : 'D√©couvrir la vid√©o' }}
          </a>
      </div>
      </div>
    {% else %}
      <p class="col-span-full text-center text-gray-400">No content available for this filter.</p>
    {% endfor %}
  </div>

  {# --- Pagination --- #}
  <div class="flex justify-center gap-2 mt-12">
    {% if page > 1 %}
      <a href="{{ path('app_shop', {'page': page - 1, 'filter': filter}) }}"
         class="px-4 py-2 bg-black text-[var(--gold,#f9b006)] border border-[var(--gold,#f9b006)] rounded-lg hover:bg-[var(--gold,#f9b006)] hover:text-black transition">
        ‚¨Ö Pr√©c√©dent
      </a>
    {% endif %}

    {% for p in 1..pages %}
      <a href="{{ path('app_shop', {'page': p, 'filter': filter}) }}"
         class="px-4 py-2 rounded-lg border {% if p == page %}bg-[var(--gold,#f9b006)] text-black font-bold{% else %}bg-black text-[var(--gold,#FFD700)] border-[var(--gold,#FFD700)] hover:bg-[var(--gold,#FFD700)] hover:text-black{% endif %}">
        {{ p }}
      </a>
    {% endfor %}

    {% if page < pages %}
      <a href="{{ path('app_shop', {'page': page + 1, 'filter': filter}) }}"
         class="px-4 py-2 bg-black text-[var(--gold,#FFD700)] border border-[var(--gold,#f9b006)] rounded-lg hover:bg-[var(--gold,#FFD700)] hover:text-black transition">
        Suivant ‚û°
      </a>
    {% endif %}
  </div>

</main>
{% endblock %}
